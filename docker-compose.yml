version: '3.8'

services:
  yue-exllamav2-interface :
    image: alissonpereiraanjos/yue-exllamav2-interface:latest  # Docker image for YuE Interface
    container_name: yue-exllamav2-interface  # Name of the container
    restart: unless-stopped  # Restart policy: always restart unless manually stopped
    ports:
      - "7860:7860"  # Map port 7860 (Gradio UI) to the host
      - "8888:8888"  # Optional: Map an additional port (e.g., for other services)
    environment:
      # Optimized for RTX 5080 16GB VRAM - downloads quantized EXL2 models for best performance
      # Options: all_bf16, all_exl2, all, false, or comma-separated model list
      # Recommended for 16GB VRAM: YuE-s1-7B-anneal-en-cot-exl2-4.0bpw,YuE-s2-1B-general-exl2-6.0bpw,YuE-upsampler
      - DOWNLOAD_MODELS=YuE-s1-7B-anneal-en-cot-exl2-4.0bpw,YuE-s2-1B-general-exl2-6.0bpw,YuE-upsampler
    volumes:
      - /path/to/models:/workspace/models  # Map the host's model directory to the container
      - /path/to/outputs:/workspace/outputs  # Map the host's output directory to the container
    deploy:
      resources:
        reservations:
          devices:
            - capabilities: [gpu]  # Enable GPU support (requires NVIDIA GPU and drivers)